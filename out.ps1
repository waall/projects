$e = [Convert]::FromBase64String('JGJhbm5lciA9IEAnCiwgLy8gLCwvICwuLy8gLC8gLC8vIC8gLywgLy8gLC8sIC8sIC8vICwvLAovLCAvLyAsX1xfLy8gLC8gLCwgLC8sIC8vICwvIC8sIC8vLCAvLC8KIC8sIC4tJyAgIGAtLiAsLy8gLy8vLywgLy8gLC8sLywgLy8gLy8vCiwgLCggICAgICAgICBgLCAvLyAsLC8vLywgLy8gLC8sLywgLy8gLAosLyAsXl5eXlxeXl5eXi8sLy8gLy8vICAvLCwvLC8sIC8vLywgLy8KIC8gLy8gICAgXFxfTyAgLyAsIC8vICwvLCAvLywgLy8vLCAvLyAsLwosLyAsLCAgICAgSl8vXCAgLywsLy8vLCAvLyAsLywvLCAvLyAsCiAvLC8gICAgICAgICAgKSwvLyAsLyAsLy8gLyAvLCAvLyAsIC4KLyAvLCwgICAgICAgIC98ICAgIC4gLCAgLy8vLCAuIC8sIC8vICwvLywgLwosIC8geDU3ICAgICAgXCBcICAgICkuIC8vLCAsKCAsLywvLCAvLyAsLywKTm8gTW9yZSBVbWJyZWxsYQonQAoKCiRzZXJ2aWNlTmFtZSA9ICJjc2NfdW1icmVsbGFhZ2VudCIKJHNlcnZpY2UgPSBHZXQtU2VydmljZSAtTmFtZSAkc2VydmljZU5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKJGN1cnJlbnRVc2VyID0gW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkKJHByaW5jaXBhbCA9IE5ldy1PYmplY3QgU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NQcmluY2lwYWwoJGN1cnJlbnRVc2VyKQppZiAoLW5vdCAkcHJpbmNpcGFsLklzSW5Sb2xlKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0J1aWx0aW5Sb2xlXTo6QWRtaW5pc3RyYXRvcikpIHsKICAgIFdyaXRlLUhvc3QgIlstXSBFc3RlIHNjcmlwdCBwcmVjaXNhIHNlciBleGVjdXRhZG8gY29tbyBBZG1pbmlzdHJhZG9yISIgLUZvcmVncm91bmRDb2xvciBSZWQKICAgIGV4aXQKfQoKV3JpdGUtSG9zdCAkYmFubmVyIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbgpXcml0ZS1Ib3N0ICIiCldyaXRlLUhvc3QgIlshXSBFeGVjdXRlIG8gY29tYW5kbzogU2V0LUV4ZWN1dGlvblBvbGljeSBSZW1vdGVTaWduZWQgLVNjb3BlIEN1cnJlbnRVc2VyIiAtRm9yZWdyb3VuZENvbG9yIFdoaXRlCldyaXRlLUhvc3QgIlshXSBFeGVjdXRlIGNvbW8gQWRtaW5pc3RyYWRvciIgLUZvcmVncm91bmRDb2xvciBXaGl0ZQpXcml0ZS1Ib3N0ICJbIV0gQXR1YWxpemUgb3MgY2FjaGVzIGUgdGVzdGUgZW0gbmF2ZWdhw6fDo28gYW7DtG5pbWEiIC1Gb3JlZ3JvdW5kQ29sb3IgV2hpdGUKCnRyeSB7CiAgaWYgKCRzZXJ2aWNlKSB7CiAgaWYgKCRzZXJ2aWNlLlN0YXR1cyAtbmUgIlN0b3BwZWQiKSB7CiAgICAgIFN0b3AtU2VydmljZSAtTmFtZSAkc2VydmljZU5hbWUgLUZvcmNlCiAgICAgIFdyaXRlLUhvc3QgIlsrXSBTZXJ2acOnbyAnJHNlcnZpY2VOYW1lJyBwYXJhZG8uIiAtRm9yZWdyb3VuZENvbG9yIEdyZWVuCiAgfSBlbHNlIHsKICAgICAgV3JpdGUtSG9zdCAiWyFdIFNlcnZpw6dvICckc2VydmljZU5hbWUnIGrDg8KhIGVzdMODwqEgcGFyYWRvLiIgLUZvcmVncm91bmRDb2xvciBCbHVlCiAgfQoKICAKICBzYy5leGUgY29uZmlnICRzZXJ2aWNlTmFtZSBzdGFydD0gZGlzYWJsZWQgfCBPdXQtTnVsbAogIFdyaXRlLUhvc3QgIlsrXSBTZXJ2acOnbyAnJHNlcnZpY2VOYW1lJyBkZXNhdGl2YWRvIGNvbSBzdWNlc3NvLiIgLUZvcmVncm91bmRDb2xvciBHcmVlbgp9IGVsc2UgewogIFdyaXRlLUhvc3QgIlstXSBTZXJ2acOnbyAnJHNlcnZpY2VOYW1lJyBuw6NvIGVuY29udHJhZG8hIiAtRm9yZWdyb3VuZENvbG9yIFJlZAp9CgoKJHVtYnJlbGxhUHJvY2VzcyA9IEdldC1Qcm9jZXNzIC1OYW1lICJhY3VtYnJlbGxhYWdlbnQiIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCmlmICgkdW1icmVsbGFQcm9jZXNzKSB7CiAgU3RvcC1Qcm9jZXNzIC1JZCAkdW1icmVsbGFQcm9jZXNzLklkIC1Gb3JjZQogIFdyaXRlLUhvc3QgIlsrXSBQcm9jZXNzbyBhY3VtYnJlbGxhYWdlbnQuZXhlIChQSUQgJCgkdW1icmVsbGFQcm9jZXNzLklkKSkgZmluYWxpemFkby4iIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4KfSBlbHNlIHsKICBXcml0ZS1Ib3N0ICJbIV0gUHJvY2Vzc28gYWN1bWJyZWxsYWFnZW50LmV4ZSBuw6NvIGVzdGEgZW0gZXhlY3XDp8Ojby4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93Cn0KCgokZG5zY3J5cHQgPSBHZXQtUHJvY2VzcyAtTmFtZSAiZG5zY3J5cHRwcm94eSIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKaWYgKCRkbnNjcnlwdCkgewogIFdyaXRlLUhvc3QgIlsrXSBkbnNjcnlwdHByb3h5LmV4ZSBlc3TDg8KhIGVtIGV4ZWN1w4PCp8ODwqNvIChQSUQgJCgkZG5zY3J5cHQuSWQpKS4iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbgp9IGVsc2UgewogIFdyaXRlLUhvc3QgIlstXSBkbnNjcnlwdHByb3h5LmV4ZSBuw4PCo28gZW5jb250cmFkbyBlbSBleGVjdcODwqfDg8Kjby4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93Cn0KfQpjYXRjaCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU1NlY3VyaXR5RXhjZXB0aW9uXSB7CiAgICAKICAgIFdyaXRlLUhvc3QgIlstXSBFcnJvOiBBIGV4ZWN1w6fDo28gZGUgc2NyaXB0cyBlc3TDo28gZGVzYWJpbGl0YWRhIG5lc3RlIHNpc3RlbWEuIgogICAgV3JpdGUtSG9zdCAiWy1dIFBhcmEgcGVybWl0aXIsIGV4ZWN1dGUgbm8gUG93ZXJTaGVsbCBjb21vIGFkbWluaXN0cmFkb3I6IgogICAgV3JpdGUtSG9zdCAiWy1dIFNldC1FeGVjdXRpb25Qb2xpY3kgUmVtb3RlU2lnbmVkIC1TY29wZSBDdXJyZW50VXNlciIKfQoKCgo='); $obfuscated = [Text.Encoding]::UTF8.GetString($e); Invoke-Expression $obfuscated